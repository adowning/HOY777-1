"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.createCdnReplacePlugin = void 0;
const getEsmReg = (lib) => {
    lib = lib.replace('/', `\/`);
    return new RegExp(`from.*(["|']${lib}["|'])`, 'g');
};
function createCdnReplacePlugin(opt) {
    return {
        name: 'vite:cdn',
        async renderChunk(code) {
            const { esm = true, modules = [] } = opt || {};
            if (!esm) {
                return {
                    code,
                    map: null,
                };
            }
            // add esm cdn link
            for (const moduleItem of modules) {
                const { name, url } = moduleItem;
                code = code.replace(getEsmReg(name), `from "${url}"`);
            }
            return { code, map: null };
        },
    };
}
exports.createCdnReplacePlugin = createCdnReplacePlugin;
